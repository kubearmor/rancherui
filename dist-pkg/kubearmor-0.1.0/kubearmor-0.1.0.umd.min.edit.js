(("undefined"!==typeof self?self:this)["webpackJsonpkubearmor_0_1_0"]=("undefined"!==typeof self?self:this)["webpackJsonpkubearmor_0_1_0"]||[]).push([[0],{"052d":function(e,t,a){"use strict";a("adc7")},"061b":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("Tab",{attrs:{name:"general",label:"General",weight:99}},[t("General",{attrs:{"data-testid":"kw-policy-config-general-tab",mode:e.mode,"target-namespace":e.targetNamespace,"is-custom":e.isCustom},model:{value:e.chartValues,callback:function(t){e.chartValues=t},expression:"chartValues"}}),t("BasicConfig",{attrs:{mode:e.mode},model:{value:e.chartValues.policy,callback:function(t){e.$set(e.chartValues,"policy",t)},expression:"chartValues.policy"}})],1),t("Tab",{attrs:{name:"selector",label:"Selector",weight:97}},[t("SelectorMatch",{attrs:{"data-testid":"ka-policy-config-selector-tab",mode:e.mode},model:{value:e.chartValues.policy,callback:function(t){e.$set(e.chartValues,"policy",t)},expression:"chartValues.policy"}})],1),t("Tab",{attrs:{name:"file",label:"File Configuration",weight:96}},[t("FileMatch",{attrs:{"data-testid":"ka-policy-config-file-tab",mode:e.mode},model:{value:e.chartValues.policy,callback:function(t){e.$set(e.chartValues,"policy",t)},expression:"chartValues.policy"}})],1),t("Tab",{attrs:{name:"process",label:"Process Configuration",weight:96}},[t("ProcessMatch",{attrs:{"data-testid":"ka-policy-config-process-tab",mode:e.mode},model:{value:e.chartValues.policy,callback:function(t){e.$set(e.chartValues,"policy",t)},expression:"chartValues.policy"}})],1),t("Tab",{attrs:{name:"network",label:"Network Configuration",weight:96}},[t("NetworkMatch",{attrs:{"data-testid":"ka-policy-config-network-tab",mode:e.mode},model:{value:e.chartValues.policy,callback:function(t){e.$set(e.chartValues,"policy",t)},expression:"chartValues.policy"}})],1)],1)},o=[],i=a("330a"),r=a.n(i),l=a("da25"),n=a("38de"),c=a("a6b3"),u=a("bafb"),d=a("a600"),p=a("2876"),h=a("3bda"),m=a("7ce4"),v=a("9541"),b={props:{customPolicy:{type:Boolean,default:!1},mode:{type:String,default:l["n"]},value:{type:Object,required:!0}},components:{General:u["default"],Tab:n["a"],SelectorMatch:c["default"],ProcessMatch:d["default"],FileMatch:p["default"],TagsInput:h["default"],BasicConfig:m["default"],NetworkMatch:v["default"]},inject:["chartType"],data(){return{activeTab:null,chartValues:null}},created(){this.value&&(this.chartValues=this.value),this.value.message||this.$set(this.value,"message","")},computed:{hasFile(){var e;return!r()(null===(e=this.chartValues)||void 0===e||null===(e=e.policy)||void 0===e||null===(e=e.spec)||void 0===e?void 0:e.file)},hasProcess(){var e;return!r()(null===(e=this.chartValues)||void 0===e||null===(e=e.policy)||void 0===e||null===(e=e.spec)||void 0===e?void 0:e.process)},hasSelector(){var e;return!r()(null===(e=this.chartValues)||void 0===e||null===(e=e.policy)||void 0===e||null===(e=e.spec)||void 0===e?void 0:e.selector)},isCreate(){return this.mode===l["n"]},isCustom(){return this.customPolicy},targetNamespace(){var e;return this.forceNamespace||(null===(e=this.chartValues)||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.namespace)||"default"}},methods:{setActiveTab(e){this.activeTab=e}}},f=b,y=a("d802"),g=Object(y["a"])(f,s,o,!1,null,null,null);t["default"]=g.exports},"099d":function(e,t,a){"use strict";a("7258")},"09a2":function(e,t,a){var s=a("0fa6");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("3456a04c",s,!0,{sourceMap:!1,shadowMode:!1})},"0fa6":function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,".step__values__controls[data-v-bdce7b86]{display:flex;margin-bottom:15px}.step__values__controls[data-v-bdce7b86]>:not(:last-of-type){margin-right:10px}.step__values__content[data-v-bdce7b86],.step__values__controls--spacer[data-v-bdce7b86]{flex:1}.step__values__content[data-v-bdce7b86] .tab-container{overflow:auto}",""]),e.exports=t},"15d2":function(e,t,a){var s={"./kubearmor/_index":"3953","./kubearmor/_index.vue":"3953","./kubearmor/admission":"061b","./kubearmor/admission/":"061b","./kubearmor/admission/BasicConfig":"7ce4","./kubearmor/admission/BasicConfig.vue":"7ce4","./kubearmor/admission/FileMatch":"2876","./kubearmor/admission/FileMatch.vue":"2876","./kubearmor/admission/General":"bafb","./kubearmor/admission/General.vue":"bafb","./kubearmor/admission/NetworkMatch":"9541","./kubearmor/admission/NetworkMatch.vue":"9541","./kubearmor/admission/ProcessMatch":"a600","./kubearmor/admission/ProcessMatch.vue":"a600","./kubearmor/admission/SelectorMatch":"a6b3","./kubearmor/admission/SelectorMatch.vue":"a6b3","./kubearmor/admission/TagsInput":"3bda","./kubearmor/admission/TagsInput.vue":"3bda","./kubearmor/admission/index":"061b","./kubearmor/admission/index.vue":"061b"};function o(e){return Promise.resolve().then((function(){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}var o=s[e];return a(o)}))}o.keys=function(){return Object.keys(s)},o.id="15d2",e.exports=o},1877:function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,'.policy-table-container[data-v-556e35b7]{display:flex;flex-direction:column;gap:1rem;padding:1rem}.policy-table-actions[data-v-556e35b7]{display:flex;justify-content:space-between;align-items:center}.filter[data-v-556e35b7]{width:100%;display:grid;grid-template-rows:1fr;grid-template-columns:repeat(2,1fr) .25fr;grid-template-areas:"attributes search reset";gap:1rem}.filter>*[data-v-556e35b7]{margin:.5rem 0}.filter__attributes[data-v-556e35b7]{grid-area:attributes}.filter__search[data-v-556e35b7]{grid-area:search}.filter__reset[data-v-556e35b7]{grid-area:reset}.filter__reset p[data-v-556e35b7]{line-height:1.5;white-space:wrap}[data-v-556e35b7] tr:hover{cursor:pointer}',""]),e.exports=t},"1f6e":function(e,t,a){"use strict";a("6d70")},2876:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"col mb-20"},[t("div",{staticClass:"col mb-40"},[t("div",{staticClass:"row mb-20"},[t("div",{staticClass:"col span-6"},[t("LabeledInput",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Specify the severity level of the policy (e.g., 1, 2, 3...).",expression:"`Specify the severity level of the policy (e.g., 1, 2, 3...).`"}],attrs:{mode:e.mode,label:"Severity",placeholder:"Enter severity level (e.g., 1)",type:"number",min:"1"},model:{value:e.file.severity,callback:function(t){e.$set(e.file,"severity",t)},expression:"file.severity"}})],1),t("div",{staticClass:"col span-6"},[t("LabeledSelect",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Specify the action to be taken when this policy is triggered (Allow, Audit, or Block).",expression:"`Specify the action to be taken when this policy is triggered (Allow, Audit, or Block).`"}],attrs:{mode:e.mode,options:e.actionOptions,label:"Action",placeholder:"Select Action"},model:{value:e.file.action,callback:function(t){e.$set(e.file,"action",t)},expression:"file.action"}})],1)])]),t("div",{staticClass:"col mb-40"},[t("h2",[e._v(" Match Paths "),t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Match file paths for security policies.",expression:"`Match file paths for security policies.`"}],staticClass:"icon icon-info"})]),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Match Path","default-add-value":{path:"",readOnly:!1,ownerOnly:!1,fromSource:[]}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"col mb-20"},[t("LabeledInput",{attrs:{mode:e.mode,required:!0,label:"Absolute file path",placeholder:"Enter the absolute file path"},model:{value:a.row.value.path,callback:function(t){e.$set(a.row.value,"path",t)},expression:"props.row.value.path"}}),t("RadioGroup",{attrs:{name:"owner-file-matchpath",mode:e.mode,options:e.booleanOptions,label:"Owner Only"},model:{value:a.row.value.ownerOnly,callback:function(t){e.$set(a.row.value,"ownerOnly",t)},expression:"props.row.value.ownerOnly"}}),t("RadioGroup",{attrs:{name:"readonly-file-matchpath",mode:e.mode,options:e.booleanOptions,label:"Read Only"},model:{value:a.row.value.readOnly,callback:function(t){e.$set(a.row.value,"readOnly",t)},expression:"props.row.value.readOnly"}}),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Source Path","default-add-value":{path:""}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("LabeledInput",{attrs:{mode:e.mode,label:"Source Path",placeholder:"Enter source path"},model:{value:a.row.value.path,callback:function(t){e.$set(a.row.value,"path",t)},expression:"sourceProps.row.value.path"}})]}}],null,!0),model:{value:a.row.value.fromSource,callback:function(t){e.$set(a.row.value,"fromSource",t)},expression:"props.row.value.fromSource"}})],1)]}}]),model:{value:e.file.matchPaths,callback:function(t){e.$set(e.file,"matchPaths",t)},expression:"file.matchPaths"}})],1),t("div",{staticClass:"col mb-40"},[t("h2",[e._v(" Match Directories "),t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Match directories for security policies.",expression:"`Match directories for security policies.`"}],staticClass:"icon icon-info"})]),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Match Directory","default-add-value":{dir:"",recursive:!1,readOnly:!1,ownerOnly:!1,fromSource:[]}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"col mb-20"},[t("LabeledInput",{attrs:{mode:e.mode,required:!0,label:"Absolute directory path",placeholder:"Enter the absolute directory path"},model:{value:a.row.value.dir,callback:function(t){e.$set(a.row.value,"dir",t)},expression:"props.row.value.dir"}}),t("RadioGroup",{attrs:{name:"recursive-file-matchdir",mode:e.mode,options:e.booleanOptions,label:"Recursive"},model:{value:a.row.value.recursive,callback:function(t){e.$set(a.row.value,"recursive",t)},expression:"props.row.value.recursive"}}),t("RadioGroup",{attrs:{name:"owner-file-matchdir",mode:e.mode,options:e.booleanOptions,label:"Owner Only"},model:{value:a.row.value.ownerOnly,callback:function(t){e.$set(a.row.value,"ownerOnly",t)},expression:"props.row.value.ownerOnly"}}),t("RadioGroup",{attrs:{name:"read-file-matchdir",mode:e.mode,options:e.booleanOptions,label:"Read Only"},model:{value:a.row.value.readOnly,callback:function(t){e.$set(a.row.value,"readOnly",t)},expression:"props.row.value.readOnly"}}),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Source Path","default-add-value":{path:""}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("LabeledInput",{attrs:{mode:e.mode,label:"Source Path",placeholder:"Enter source path"},model:{value:a.row.value.path,callback:function(t){e.$set(a.row.value,"path",t)},expression:"sourceProps.row.value.path"}})]}}],null,!0),model:{value:a.row.value.fromSource,callback:function(t){e.$set(a.row.value,"fromSource",t)},expression:"props.row.value.fromSource"}})],1)]}}]),model:{value:e.file.matchDirectories,callback:function(t){e.$set(e.file,"matchDirectories",t)},expression:"file.matchDirectories"}})],1),t("div",{staticClass:"col mb-40"},[t("h2",[e._v(" Match Patterns "),t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Match file patterns using regex.",expression:"`Match file patterns using regex.`"}],staticClass:"icon icon-info"})]),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Match Pattern","default-add-value":{pattern:"",readOnly:!1,ownerOnly:!1}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"col mb-20"},[t("LabeledInput",{attrs:{mode:e.mode,required:!0,label:"Regex Pattern",placeholder:"Enter the regex pattern"},model:{value:a.row.value.pattern,callback:function(t){e.$set(a.row.value,"pattern",t)},expression:"props.row.value.pattern"}}),t("RadioGroup",{attrs:{name:"owner-file-matchpattern",mode:e.mode,options:e.booleanOptions,label:"Owner Only"},model:{value:a.row.value.ownerOnly,callback:function(t){e.$set(a.row.value,"ownerOnly",t)},expression:"props.row.value.ownerOnly"}}),t("RadioGroup",{attrs:{name:"read-file-matchpattern",mode:e.mode,options:e.booleanOptions,label:"Read Only"},model:{value:a.row.value.readOnly,callback:function(t){e.$set(a.row.value,"readOnly",t)},expression:"props.row.value.readOnly"}})],1)]}}]),model:{value:e.file.matchPatterns,callback:function(t){e.$set(e.file,"matchPatterns",t)},expression:"file.matchPatterns"}})],1)])},o=[],i=a("da25"),r=a("a0fb"),l=a("8e93"),n=a("466b"),c=a("e143"),u={props:{mode:{type:String,default:i["n"]},value:{type:Object,required:!0}},components:{ArrayListGrouped:r["a"],LabeledInput:l["a"],LabeledSelect:n["a"],RadioGroup:c["a"]},data(){return this.value.spec||this.$set(this.value,"spec",{}),this.value.spec.file||this.$set(this.value.spec,"file",{severity:1,action:"Block",matchPaths:[],matchDirectories:[],matchPatterns:[]}),{file:this.value.spec.file,booleanOptions:[{label:"True",value:!0},{label:"False",value:!1}],actionOptions:[{label:"Allow",value:"Allow"},{label:"Audit",value:"Audit"},{label:"Block",value:"Block"}]}},watch:{file:{deep:!0,handler(e){this.$set(this.value.spec,"file",e),this.$emit("input",this.value)}}}},d=u,p=a("d802"),h=Object(p["a"])(d,s,o,!1,null,null,null);t["default"]=h.exports},"29be":function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,".content[data-v-63892b7c]{position:relative;z-index:1}.banner__title[data-v-63892b7c]{padding-top:10px;margin-bottom:10px;border-bottom:1px solid var(--border);min-height:60px}.banner__readme-button[data-v-63892b7c]{padding:0 7px 0 0}",""]),e.exports=t},3953:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"row mb-20"},[t("Checkbox",{attrs:{label:"Enable the Recommended Policies",tooltip:"The chart allows the user to install some recommended policies to enforce some best practice security checks."},model:{value:e.value["kubearmor-defaults"].recommendedPolicies.enabled,callback:function(t){e.$set(e.value["kubearmor-defaults"].recommendedPolicies,"enabled",t)},expression:"value['kubearmor-defaults'].recommendedPolicies.enabled"}})],1)])},o=[],i=a("da25"),r=a("0df0"),l={props:{chart:{type:Object,default:()=>({})},mode:{type:String,default:i["n"]},value:{type:Object,default:()=>({})}},components:{Checkbox:r["a"]}},n=l,c=a("d802"),u=Object(c["a"])(n,s,o,!1,null,null,null);t["default"]=u.exports},"3bda":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("h4",[e._v("Tags")]),t("div",{staticClass:"tags-input"},[e._l(e.tags,(function(a,s){return t("div",{key:s,staticClass:"tag-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.tags[s],expression:"tags[index]"}],staticClass:"tag-input",attrs:{placeholder:"Enter tag"},domProps:{value:e.tags[s]},on:{input:[function(t){t.target.composing||e.$set(e.tags,s,t.target.value)},e.updateTags]}}),t("button",{staticClass:"remove-btn",on:{click:function(t){return e.removeTag(s)}}},[e._v("x")])])})),t("button",{staticClass:"add-btn",on:{click:e.addTag}},[e._v("Add Tag")])],2)])},o=[],i={props:{value:{type:Array,default:()=>[]}},data(){return{tags:this.value}},watch:{tags:{deep:!0,handler(e){this.$emit("input",e)}}},methods:{addTag(){this.tags.push("")},removeTag(e){this.tags.splice(e,1)},updateTags(){this.$emit("input",this.tags)}}},r=i,l=(a("052d"),a("d802")),n=Object(l["a"])(r,s,o,!1,null,"66b7c3cb",null);t["default"]=n.exports},"5ea7":function(e,t,a){var s={"./kubearmor/_index":"3953","./kubearmor/_index.vue":"3953","./kubearmor/admission":"061b","./kubearmor/admission/":"061b","./kubearmor/admission/BasicConfig":"7ce4","./kubearmor/admission/BasicConfig.vue":"7ce4","./kubearmor/admission/FileMatch":"2876","./kubearmor/admission/FileMatch.vue":"2876","./kubearmor/admission/General":"bafb","./kubearmor/admission/General.vue":"bafb","./kubearmor/admission/NetworkMatch":"9541","./kubearmor/admission/NetworkMatch.vue":"9541","./kubearmor/admission/ProcessMatch":"a600","./kubearmor/admission/ProcessMatch.vue":"a600","./kubearmor/admission/SelectorMatch":"a6b3","./kubearmor/admission/SelectorMatch.vue":"a6b3","./kubearmor/admission/TagsInput":"3bda","./kubearmor/admission/TagsInput.vue":"3bda","./kubearmor/admission/index":"061b","./kubearmor/admission/index.vue":"061b"};function o(e){var t=i(e);return a(t)}function i(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}o.keys=function(){return Object.keys(s)},o.resolve=i,e.exports=o,o.id="5ea7"},"61c1":function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,".name-col div[data-v-1d1d0d06]:after,.name-col div[data-v-1d1d0d06]:before{content:unset;display:unset}",""]),e.exports=t},6341:function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,"[data-v-2761b367] .header{display:none}[data-v-2761b367] .controls-row{position:sticky;width:auto}[data-v-2761b367] .controls-row .controls-steps{display:flex}[data-v-2761b367] .custom{min-height:110px}[data-v-2761b367] .subtype{height:110px;margin:10px;position:relative;border-radius:calc(var(--border-radius)*1.5);border:1px solid var(--border);text-decoration:none!important;color:var(--body-text)!important}[data-v-2761b367] .subtype:hover:not(.disabled){box-shadow:0 0 30px var(--shadow);transition:box-shadow .1s ease-in-out;cursor:pointer;text-decoration:none!important}[data-v-2761b367] .subtype__metadata{padding:10px}[data-v-2761b367] .subtype__metadata__description,[data-v-2761b367] .subtype__metadata__label{padding-right:20px}[data-v-2761b367] .subtype__badge{position:absolute;right:0;top:0;padding:4px 5px;border-bottom-left-radius:var(--border-radius)}[data-v-2761b367] .subtype__badge label{font-size:12px;line-height:12px;text-align:center;display:block;white-space:no-wrap;text-overflow:ellipsis;color:var(--app-rancher-accent-text);margin:0}[data-v-2761b367] .subtype__label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:4px;line-height:normal}[data-v-2761b367] .subtype__description{margin-right:10px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;line-clamp:3;overflow:hidden;text-overflow:ellipsis;color:var(--input-label)}[data-v-2761b367] .footer-error{margin-top:15px}.wizard[data-v-2761b367]{position:relative;height:100%;z-index:1}.banner__title[data-v-2761b367]{padding-top:10px;margin-bottom:10px;border-bottom:1px solid var(--border);min-height:60px}.banner__readme-button[data-v-2761b367]{padding:0 7px 0 0}",""]),e.exports=t},"6d70":function(e,t,a){var s=a("1877");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("3a58a165",s,!0,{sourceMap:!1,shadowMode:!1})},"6e79":function(e,t,a){var s=a("29be");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("f7b3317e",s,!0,{sourceMap:!1,shadowMode:!1})},7257:function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,"[data-v-69136ac1] .btn-sm{padding:0 7px 0 0}.policy-info-panel[data-v-69136ac1]{position:fixed;top:0;left:0;z-index:2;overflow-y:auto;--banner-top-offset:0}.policy-info-panel .glass[data-v-69136ac1]{left:0;width:100%;opacity:0}.policy-info-panel .glass[data-v-69136ac1],.policy-info-panel .slideIn[data-v-69136ac1]{position:fixed;top:calc(54px + var(--banner-top-offset));height:calc(100% - 54px - var(--banner-top-offset));overflow-y:auto}.policy-info-panel .slideIn[data-v-69136ac1]{border-left:var(--header-border-size) solid var(--header-border);right:-45%;background-color:var(--topmenu-bg);width:45%;display:flex;flex-direction:column;box-shadow:-3px 0 5px rgba(0,0,0,.1);padding:10px;transition:right .5s ease}.policy-info-panel .slideIn__header[data-v-69136ac1]{text-transform:capitalize}.policy-info-panel .slideIn .policy-info-content[data-v-69136ac1]{display:flex;flex-direction:column;overflow-y:auto}.policy-info-panel .slideIn h3[data-v-69136ac1]{font-size:14px;margin:0;opacity:.7;text-transform:uppercase}.policy-info-panel .slideIn .policy-header[data-v-69136ac1]{border-bottom:1px solid var(--border);display:flex;align-items:center}.policy-info-panel .slideIn .policy-header .policy-title[data-v-69136ac1]{flex:1}.policy-info-panel .slideIn__header[data-v-69136ac1]{display:flex;align-items:center;justify-content:space-between}.policy-info-panel .slideIn__header__buttons[data-v-69136ac1]{display:flex;align-items:center}.policy-info-panel .slideIn__header__button[data-v-69136ac1]{cursor:pointer;display:flex;align-items:center;justify-content:center}.policy-info-panel .slideIn__header__button>i[data-v-69136ac1]{font-size:20px;opacity:.5}.policy-info-panel .slideIn__header__button[data-v-69136ac1]:hover{background-color:var(--wm-closer-hover-bg)}.policy-info-panel .slideIn__show[data-v-69136ac1]{right:0}",""]),e.exports=t},7258:function(e,t,a){var s=a("cef3");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("77e73f26",s,!0,{sourceMap:!1,shadowMode:!1})},7303:function(e,t,a){var s=a("7257");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("0754c8fd",s,!0,{sourceMap:!1,shadowMode:!1})},"7ce4":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"col mb-20"},[t("LabeledInput",{attrs:{mode:e.mode,type:"number",label:"Severity",placeholder:"Enter a severity level (1-10)",min:"1",max:"10",tooltip:"Specify the severity level (default is 1)"},model:{value:e.severity,callback:function(t){e.severity=t},expression:"severity"}})],1),t("div",{staticClass:"col mb-20"},[t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Tag","default-add-value":"",tooltip:"Add tags related to the policy"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("LabeledInput",{attrs:{mode:e.mode,label:"Tag",placeholder:"Enter a tag"},model:{value:a.row.value,callback:function(t){e.$set(a.row,"value",t)},expression:"props.row.value"}})]}}]),model:{value:e.tags,callback:function(t){e.tags=t},expression:"tags"}})],1),t("div",{staticClass:"col mb-20"},[t("LabeledInput",{attrs:{mode:e.mode,label:"Message",placeholder:"Enter a message",tooltip:"Enter a message to be displayed when the policy is triggered"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1)])},o=[],i=a("da25"),r=a("8e93"),l=a("a0fb"),n={name:"BasicConfig",props:{mode:{type:String,default:i["n"]},value:{type:Object,required:!0}},components:{LabeledInput:r["a"],ArrayListGrouped:l["a"]},data(){return this.value.spec||this.$set(this.value,"spec",{}),void 0===this.value.spec.severity&&this.$set(this.value.spec,"severity",1),this.value.spec.tags||this.$set(this.value.spec,"tags",[]),this.value.spec.message||this.$set(this.value.spec,"message",""),{severity:this.value.spec.severity,tags:this.value.spec.tags,message:this.value.spec.message}},watch:{severity(e){this.$set(this.value.spec,"severity",e),this.$emit("input",this.value)},tags:{deep:!0,handler(e){this.$set(this.value.spec,"tags",e),this.$emit("input",this.value)}},message(e){this.$set(this.value.spec,"message",e),this.$emit("input",this.value)}}},c=n,u=a("d802"),d=Object(u["a"])(c,s,o,!1,null,null,null);t["default"]=d.exports},8086:function(e,t,a){"use strict";a("e646")},"915a":function(e,t,a){"use strict";a("7303")},9541:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"col mb-20"},[t("div",{staticClass:"col mb-40"},[t("h2",[e._v(" Match Protocols "),t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Specify the network protocols to be matched.",expression:"`Specify the network protocols to be matched.`"}],staticClass:"icon icon-info"})]),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Match Protocol","default-add-value":{protocol:"",fromSource:[]}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"col mb-20"},[t("LabeledSelect",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Select a network protocol (TCP, UDP, ICMP) to match.",expression:"`Select a network protocol (TCP, UDP, ICMP) to match.`"}],attrs:{mode:e.mode,options:e.protocolOptions,label:"Protocol",placeholder:"Select protocol"},model:{value:a.row.value.protocol,callback:function(t){e.$set(a.row.value,"protocol",t)},expression:"props.row.value.protocol"}})],1),t("div",{staticClass:"col mb-20"},[t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Source Path","default-add-value":{path:""}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("LabeledInput",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Specify the executable path that accesses this protocol.",expression:"`Specify the executable path that accesses this protocol.`"}],attrs:{mode:e.mode,label:"Source Path",placeholder:"Enter source executable path"},model:{value:a.row.value.path,callback:function(t){e.$set(a.row.value,"path",t)},expression:"sourceProps.row.value.path"}})]}}],null,!0),model:{value:a.row.value.fromSource,callback:function(t){e.$set(a.row.value,"fromSource",t)},expression:"props.row.value.fromSource"}})],1)]}}]),model:{value:e.value.spec.network.matchProtocols,callback:function(t){e.$set(e.value.spec.network,"matchProtocols",t)},expression:"value.spec.network.matchProtocols"}})],1)])},o=[],i=a("da25"),r=a("a0fb"),l=a("8e93"),n=a("466b"),c={props:{mode:{type:String,default:i["n"]},value:{type:Object,required:!0}},components:{ArrayListGrouped:r["a"],LabeledInput:l["a"],LabeledSelect:n["a"]},data(){return this.value.spec||this.$set(this.value,"spec",{}),this.value.spec.network||this.$set(this.value.spec,"network",{matchProtocols:[]}),{protocolOptions:[{label:"TCP",value:"TCP"},{label:"UDP",value:"UDP"},{label:"ICMP",value:"ICMP"}],network:this.value.spec.network}},watch:{network:{deep:!0,handler(e){this.$set(this.value.spec,"network",e),this.$emit("input",this.value)}}}},u=c,d=a("d802"),p=Object(d["a"])(u,s,o,!1,null,null,null);t["default"]=p.exports},9901:function(e,t,a){var s=a("6341");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("26080d71",s,!0,{sourceMap:!1,shadowMode:!1})},99026:function(e,t,a){"use strict";a("09a2")},"9f26":function(e,t,a){"use strict";a("9901")},a600:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"col mb-20"},[t("div",{staticClass:"row mb-20"},[t("div",{staticClass:"col span-6"},[t("LabeledSelect",{attrs:{mode:e.mode,label:"Action",options:e.actionOptions,placeholder:"Select action (default: Block)"},model:{value:e.process.action,callback:function(t){e.$set(e.process,"action",t)},expression:"process.action"}})],1),t("div",{staticClass:"col span-6"},[t("LabeledInput",{attrs:{mode:e.mode,label:"Severity",type:"number",min:"1",placeholder:"Enter severity level (e.g., 1)"},model:{value:e.process.severity,callback:function(t){e.$set(e.process,"severity",t)},expression:"process.severity"}})],1)]),t("div",{staticClass:"col mb-40"},[t("h2",[e._v(" Match Paths "),t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Specify paths to match executables.",expression:"`Specify paths to match executables.`"}],staticClass:"icon icon-info"})]),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Match Path",required:!0,"default-add-value":{path:"",fromSource:[]}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"col mb-20"},[t("LabeledInput",{attrs:{mode:e.mode,required:!0,label:"Absolute Path",placeholder:"Enter the executable path"},model:{value:a.row.value.path,callback:function(t){e.$set(a.row.value,"path",t)},expression:"props.row.value.path"}}),t("RadioGroup",{attrs:{name:"owner-process-matchpath",mode:e.mode,options:e.booleanOptions,label:"Owner Only"},model:{value:a.row.value.ownerOnly,callback:function(t){e.$set(a.row.value,"ownerOnly",t)},expression:"props.row.value.ownerOnly"}}),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Source Path","default-add-value":{path:""}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("LabeledInput",{attrs:{mode:e.mode,label:"Source Path",placeholder:"Enter source path"},model:{value:a.row.value.path,callback:function(t){e.$set(a.row.value,"path",t)},expression:"sourceProps.row.value.path"}})]}}],null,!0),model:{value:a.row.value.fromSource,callback:function(t){e.$set(a.row.value,"fromSource",t)},expression:"props.row.value.fromSource"}})],1)]}}]),model:{value:e.process.matchPaths,callback:function(t){e.$set(e.process,"matchPaths",t)},expression:"process.matchPaths"}})],1),t("div",{staticClass:"col mb-40"},[t("h2",[e._v(" Match Directories "),t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Specify directories to match.",expression:"`Specify directories to match.`"}],staticClass:"icon icon-info"})]),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Match Directory","default-add-value":{dir:"",recursive:!1,ownerOnly:!1,fromSource:[]}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"col mb-20"},[t("LabeledInput",{attrs:{mode:e.mode,required:!0,label:"Directory Path",placeholder:"Enter the directory path"},model:{value:a.row.value.dir,callback:function(t){e.$set(a.row.value,"dir",t)},expression:"props.row.value.dir"}}),t("RadioGroup",{attrs:{name:"recursive-process-matchdir",mode:e.mode,options:e.booleanOptions,label:"Recursive"},model:{value:a.row.value.recursive,callback:function(t){e.$set(a.row.value,"recursive",t)},expression:"props.row.value.recursive"}}),t("RadioGroup",{attrs:{name:"owner-process-matchdir",mode:e.mode,options:e.booleanOptions,label:"Owner Only"},model:{value:a.row.value.ownerOnly,callback:function(t){e.$set(a.row.value,"ownerOnly",t)},expression:"props.row.value.ownerOnly"}}),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Source Path","default-add-value":{path:""}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("LabeledInput",{attrs:{mode:e.mode,label:"Source Path",placeholder:"Enter source path"},model:{value:a.row.value.path,callback:function(t){e.$set(a.row.value,"path",t)},expression:"sourceProps.row.value.path"}})]}}],null,!0),model:{value:a.row.value.fromSource,callback:function(t){e.$set(a.row.value,"fromSource",t)},expression:"props.row.value.fromSource"}})],1)]}}]),model:{value:e.process.matchDirectories,callback:function(t){e.$set(e.process,"matchDirectories",t)},expression:"process.matchDirectories"}})],1),t("div",{staticClass:"col mb-40"},[t("h2",[e._v(" Match Patterns "),t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"Define regex patterns to match processes.",expression:"`Define regex patterns to match processes.`"}],staticClass:"icon icon-info"})]),t("ArrayListGrouped",{attrs:{mode:e.mode,"add-label":"Add Match Pattern","default-add-value":{pattern:"",ownerOnly:!1}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"col mb-20"},[t("LabeledInput",{attrs:{mode:e.mode,required:!0,label:"Pattern",placeholder:"Enter regex pattern"},model:{value:a.row.value.pattern,callback:function(t){e.$set(a.row.value,"pattern",t)},expression:"props.row.value.pattern"}}),t("RadioGroup",{attrs:{name:"owner-process-matchpattern",mode:e.mode,options:e.booleanOptions,label:"Owner Only"},model:{value:a.row.value.ownerOnly,callback:function(t){e.$set(a.row.value,"ownerOnly",t)},expression:"props.row.value.ownerOnly"}})],1)]}}]),model:{value:e.process.matchPatterns,callback:function(t){e.$set(e.process,"matchPatterns",t)},expression:"process.matchPatterns"}})],1)])},o=[],i=a("a0fb"),r=a("8e93"),l=a("e143"),n=a("466b"),c=a("da25"),u={props:{mode:{type:String,default:c["n"]},value:{type:Object,required:!0}},components:{ArrayListGrouped:i["a"],LabeledInput:r["a"],RadioGroup:l["a"],LabeledSelect:n["a"]},data(){return this.value.spec||this.$set(this.value,"spec",{}),this.value.spec.process||this.$set(this.value.spec,"process",{action:"Block",severity:1,matchPaths:[],matchDirectories:[],matchPatterns:[]}),{process:this.value.spec.process,actionOptions:[{label:"Allow",value:"Allow"},{label:"Audit",value:"Audit"},{label:"Block",value:"Block"}],booleanOptions:[{label:"True",value:!0},{label:"False",value:!1}]}},watch:{process:{deep:!0,handler(e){this.$set(this.value.spec,"process",e),this.$emit("input",this.value)}}}},d=u,p=a("d802"),h=Object(p["a"])(d,s,o,!1,null,null,null);t["default"]=h.exports},a6b3:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("InfoBox",{ref:"infobox"},[t("h4",[e._v(" Match Labels "),t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:"MatchLabel for Kubearmor",expression:"('MatchLabel for Kubearmor')"}],staticClass:"icon icon-info icon-lg"})]),t("div",{staticClass:"row mb-20"},[t("div",{staticClass:"col span-12"},[t("KeyValue",{attrs:{mode:e.mode,"add-label":e.t("labels.addLabel"),placeholder:"Enter match label key"},model:{value:e.matchLabels,callback:function(t){e.matchLabels=t},expression:"matchLabels"}})],1)])])],1)},o=[],i=a("a232"),r=a("13a9"),l=a("da25"),n={props:{mode:{type:String,default:l["n"]},value:{type:Object,required:!0}},components:{KeyValue:i["a"],InfoBox:r["a"]},data(){return this.value.spec||this.$set(this.value,"spec",{}),this.value.spec.selector||this.$set(this.value.spec,"selector",{}),this.value.spec.selector.matchLabels||this.$set(this.value.spec.selector,"matchLabels",{}),{matchLabels:this.value.spec.selector.matchLabels}},watch:{matchLabels:{deep:!0,handler(e){this.$set(this.value.spec.selector,"matchLabels",e),this.$emit("input",this.value)}}}},c=n,u=a("d802"),d=Object(u["a"])(c,s,o,!1,null,null,null);t["default"]=d.exports},adc7:function(e,t,a){var s=a("de79");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("e8aac942",s,!0,{sourceMap:!1,shadowMode:!1})},bafb:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return e.$fetchState.pending?t("Loading",{attrs:{mode:"relative"}}):t("div",[t("div",{staticClass:"row"},[t("div",{ref:"nameNsDescriptionWrapper",staticClass:"col span-6 name-col"},[t("NameNsDescription",{attrs:{"data-testid":"kw-policy-general-name-input",mode:e.mode,value:e.policy,namespaced:!e.isGlobal,"namespace-new-allowed":!0,"name-key":"metadata.name","namespace-key":"metadata.namespace"},on:{isNamespaceNew:function(t){e.isNamespaceNew=t}}})],1)])])},o=[],i=(a("330a"),a("da25")),r=a("e24b"),l=a("466b"),n=a("15ca"),c=a("3c8c"),u=a("6418"),d=a("8e93"),p=a("e143"),h=a("90cd"),m={name:"General",inject:["chartType"],props:{mode:{type:String,default:i["n"]},targetNamespace:{type:String,required:!0},isCustom:{type:Boolean,default:!1},value:{type:Object,required:!0}},components:{LabeledSelect:l["a"],Loading:n["a"],NameNsDescription:c["a"],Banner:u["a"],LabeledInput:d["a"],RadioGroup:p["a"]},async fetch(){this.$store.getters["cluster/canList"](h["g"].POLICY_SERVER)&&await this.$store.dispatch("cluster/findAll",{type:h["g"].POLICY_SERVER})},data(){var e;let t=null;return t=null!==(e=this.value)&&void 0!==e&&e.policy?this.value.policy:this.value||{},this.mode===i["n"]&&this.chartType===h["g"].ADMISSION_POLICY&&Object(r["i"])(t.metadata,"namespace","default"),{policy:t,initialPolicyMode:null,isNamespaceNew:!1}},watch:{isNamespaceNew(e){this.$set(this.value,"isNamespaceNew",e)}},created(){this.policyMode&&(this.initialPolicyMode=this.policyMode)},beforeUpdate(){this.$nextTick(()=>{var e;const t=null===(e=this.$refs)||void 0===e?void 0:e.nameNsDescriptionWrapper,a=null===t||void 0===t?void 0:t.querySelectorAll(".row.mb-20 > .col.span-3");this.isGlobal?1===(null===a||void 0===a?void 0:a.length)&&(a[0].classList.remove("span-3"),a[0].classList.add("span-12")):2===(null===a||void 0===a?void 0:a.length)&&(a[0].classList.remove("span-3"),a[0].classList.add("span-4"),a[1].classList.remove("span-3"),a[1].classList.add("span-8"))})},computed:{isCreate(){return this.mode===i["n"]},isGlobal(){return this.chartType===h["g"].CLUSTER_ADMISSION_POLICY},modeDisabled(){return!this.isCreate&&"protect"===this.initialPolicyMode},policyMode(){var e;return null===(e=this.value)||void 0===e||null===(e=e.policy)||void 0===e||null===(e=e.spec)||void 0===e?void 0:e.mode},policyServers(){return this.$store.getters["cluster/all"](h["g"].POLICY_SERVER)},policyServerOptions(){var e;if((null===(e=this.policyServers)||void 0===e?void 0:e.length)>0){const e=[];return this.policyServers.map(t=>e.push(t.id)),e}return this.policyServers||[]},showModeBanner(){return!this.isCreate&&"monitor"===this.initialPolicyMode&&"protect"===this.policyMode}}},v=m,b=(a("8086"),a("d802")),f=Object(b["a"])(v,s,o,!1,null,"1d1d0d06",null);t["default"]=f.exports},cef3:function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,"[data-v-7d654f0e] .cru__footer{z-index:1}",""]),e.exports=t},da42:function(e,t,a){"use strict";a("6e79")},de79:function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,".tags-input[data-v-66b7c3cb]{display:flex;flex-direction:column;gap:8px}.tag-item[data-v-66b7c3cb]{display:flex;align-items:center}.tag-input[data-v-66b7c3cb]{flex:1;padding:6px;margin-right:6px}.remove-btn[data-v-66b7c3cb]{background-color:red}.add-btn[data-v-66b7c3cb],.remove-btn[data-v-66b7c3cb]{color:#fff;border:none;cursor:pointer}.add-btn[data-v-66b7c3cb]{margin-top:10px;background-color:#5cb85c;padding:5px 10px}",""]),e.exports=t},e5d3:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return e.isCreate?t("Created",{attrs:{value:e.value,mode:e.mode}}):t("CruResource",{attrs:{resource:e.value,mode:e.realMode,"can-yaml":!1},on:{finish:e.finish}},[t("Configed",{attrs:{value:e.value,mode:e.realMode},on:{updateYamlValues:e.updateYamlValuesFromEdit}})],1)},o=[],i=a("7838"),r=a.n(i),l=a("da25"),n=a("305c"),c=a("fd5f"),u=a("330a"),d=a.n(u),p=a("b506"),h=a.n(p);function m(e){return Object.keys(e).forEach(t=>{const a=e[t];void 0===a||null===a||""===a||Array.isArray(a)&&!a.length?delete e[t]:h()(a)&&(m(a),d()(a)&&delete e[t])}),d()(e)?null:e}function v(e){var t;const a=(null===(t=e.error)||void 0===t?void 0:t.data)||e.error,s=e.type||"Error";e.store.dispatch("growl/"+s.toLowerCase(),{title:a._statusText||s,message:a.message,timeout:5e3},{root:!0})}var b=function(){var e=this,t=e._self._c;return e.$fetchState.pending?t("Loading"):t("div",[t("div",{staticClass:"content"},[t("div",{staticClass:"banner__title"},[e.shortDescription?[t("p",{staticClass:"banner__short-description"},[e._v(" "+e._s(e.shortDescription)+" ")]),e.policyReadme?t("button",{staticClass:"btn btn-sm role-link banner__readme-button",on:{click:e.showReadme}},[e._v(" "+e._s("Show Readme")+" ")]):e._e()]:e._e()],2),t("Values",{attrs:{value:e.value,"chart-values":e.chartValues,"yaml-values":e.yamlValues,mode:e.mode},on:{updateYamlValues:function(t){return e.$emit("updateYamlValues",t)}}})],1),e.policyReadme?[t("PolicyReadmePanel",{ref:"readmePanel",attrs:{"package-values":e.artifactHubPackage}})]:e._e()],2)},f=[],y=a("1fcb"),g=a.n(y),w=a("c5e6"),k=a("e24b"),_=a("15ca"),x=a("90cd"),O=function(){var e=this,t=e._self._c;return e.$fetchState.pending?t("Loading",{attrs:{mode:"relative"}}):t("div",[e.isCreate||e.isEdit?t("div",{staticClass:"step__values__controls"},[t("ButtonGroup",{attrs:{"data-testid":"kw-policy-config-yaml-option",options:e.YAML_OPTIONS,"inactive-class":"bg-disabled btn-sm","active-class":"bg-primary btn-sm"},model:{value:e.yamlOption,callback:function(t){e.yamlOption=t},expression:"yamlOption"}})],1):e._e(),t("div",{staticClass:"scroll__container"},[t("div",{staticClass:"scroll__content"},[e.showForm?[t("Tabbed",{ref:"tabs",staticClass:"step__values__content",attrs:{"side-tabs":!0},on:{changed:function(t){return e.tabChanged(t)}}},[e.valuesComponent?[t(e.valuesComponent,{tag:"component",attrs:{mode:e.mode,"custom-policy":e.customPolicy},model:{value:e.chartValues,callback:function(t){e.chartValues=t},expression:"chartValues"}})]:e._e()],2)]:!e.isCreate&&!e.isEdit||e.showForm?e._e():[t("YamlEditor",{ref:"yaml",staticClass:"step__values__content",attrs:{"data-testid":"kw-policy-config-yaml-editor",scrolling:!0,"initial-yaml-values":e.originalYamlValues,"editor-mode":e.editorMode,"rhide-preview-buttons":!0},on:{onChanges:e.updateYamlValues},model:{value:e.currentYamlValues,callback:function(t){e.currentYamlValues=t},expression:"currentYamlValues"}})],t("ResourceCancelModal",{ref:"cancelModal",attrs:{"data-testid":"kw-policy-config-yaml-cancel","is-cancel-modal":!1,"is-form":!0},on:{"cancel-cancel":function(t){e.preYamlOption=e.yamlOption},"confirm-cancel":function(t){e.yamlOption=e.preYamlOption}}})],2)])])},C=[],S=a("907c"),P=a("cc2d"),$=a("6860"),M=a("0cb2"),V=a("870a"),L={name:"Values",props:{mode:{type:String,default:l["t"]},chartValues:{type:Object,default:()=>{}},customPolicy:{type:Boolean,default:!1},value:{type:Object,required:!0},yamlValues:{type:String,default:""}},components:{ButtonGroup:P["a"],Loading:_["a"],ResourceCancelModal:$["a"],Tabbed:M["a"],YamlEditor:V["b"]},async fetch(){try{this.version=this.$store.getters["catalog/version"]({repoType:"cluster",repoName:"kubearmor",chartName:x["h"].CONTROLLER}),await this.loadValuesComponent()}catch(e){console.warn("Unable to fetch Version: "+e)}this.generateYaml()},data(){return{YAML_OPTIONS:x["k"],currentYamlValues:"",originalYamlValues:"",showForm:!0,valuesComponent:null,preYamlOption:x["j"].FORM,yamlOption:x["j"].FORM}},mounted(){},watch:{yamlOption(e,t){switch(e){case x["j"].FORM:this.showForm=!0,this.$emit("editor",e);break;case x["j"].YAML:t===x["j"].FORM&&(this.currentYamlValues=Object(w["c"])(this.chartValues.policy),this.updateYamlValues()),this.showForm=!1,this.$emit("editor",e);break}}},computed:{editorMode(){return V["a"].EDIT_CODE},isCreate(){return this.mode===l["n"]},isEdit(){return this.mode===l["p"]}},methods:{artifactHubPackageVersion(){return()=>{if(!this.artifactHubWhitelist)return{error:"ArtifactHub.io has not been added to the `management.cattle.io.settings/whitelist-domain` setting"};try{var e;const t=null===(e=this.metadata)||void 0===e||null===(e=e.annotations)||void 0===e?void 0:e[x["b"]];if(t){const e=`/meta/proxy/${x["a"]}/packages/kubearmor/${t}`;return this.$dispatch("management/request",{url:e,redirectUnauthorized:!1},{root:!0})}}catch(t){console.warn("Error fetching pkg version: "+t)}}},parsePackageMetadata(e){if(e){const t=JSON.parse(JSON.stringify(e));return jsyaml.load(t)}return null},generateYaml(){var e,t;const a=this.$store.getters["cluster/all"](S["w"]),s=null!==(e=this.chartValues)&&void 0!==e&&e.policy?structuredClone(this.chartValues.policy):this.value;var o;null!==(t=this.yamlValues)&&void 0!==t&&t.length?this.currentYamlValues=this.yamlValues:this.currentYamlValues=Object(w["a"])(a,null===(o=this.value)||void 0===o?void 0:o.type,s)},haveComponent(e){try{return a("5ea7").resolve("./"+e),!0}catch(t){return!1}},importComponent(e){if(!e)throw new Error("Name required");return()=>a("15d2")("./"+e)},async loadValuesComponent(){null!==this&&void 0!==this&&this.haveComponent("kubearmor/admission")&&(this.valuesComponent=this.importComponent("kubearmor/admission"),await this.valuesComponent())},tabChanged(){window.scrollTop=0},updateYamlValues(){this.$emit("updateYamlValues",this.currentYamlValues)}}},A=L,I=(a("99026"),a("d802")),T=Object(I["a"])(A,O,C,!1,null,"bdce7b86",null),R=T.exports,E=function(){var e=this,t=e._self._c;return t("div",{staticClass:"policy-info-panel",style:"--banner-top-offset: 0px"},[t("h1",[e._v("readme")]),e.showSlideIn?t("div",{staticClass:"glass",attrs:{"data-testid":"extension-details-bg"},on:{click:function(t){return e.hide()}}}):e._e(),t("div",{staticClass:"slideIn",class:{hide:!1,slideIn__show:e.showSlideIn},attrs:{"data-testid":"extension-details"}},[t("div",{staticClass:"slideIn__header"},[e.packageValues?t("div",{staticClass:"policy-info-content"},[t("div",{staticClass:"policy-header pb-10"},[t("div",{staticClass:"slideIn__header__buttons"},[t("button",{staticClass:"btn btn-sm role-link",on:{click:e.hide}},[t("span",[e._v(e._s(e.t("generic.close")))]),t("i",{staticClass:"icon icon-chevron-right"})])])]),t("div",{staticClass:"policy-title mt-20"},[t("h2",{staticClass:"policy-info-title"},[e._v(" "+e._s(e.packageValues.display_name)+" ")])]),t("ChartReadme",{staticClass:"mt-20",attrs:{"version-info":e.packageValues}})],1):e._e()])])])},N=[],j=a("9ce4"),B=a("7202"),D={props:{packageValues:{type:Object,required:!0}},components:{ChartReadme:B["a"]},data(){return{showSlideIn:!1,info:void 0,infoVersion:void 0,versionInfo:void 0,versionError:void 0,headerBannerSize:0}},computed:{...Object(j["a"])({theme:"prefs/theme"}),applyDarkModeBg(){return"dark"===this.theme?{"dark-mode":!0}:{}}},methods:{show(){this.showSlideIn=!0},hide(){this.showSlideIn=!1}}},G=D,Y=(a("915a"),Object(I["a"])(G,E,N,!1,null,"69136ac1",null)),q=Y.exports,F={name:"Config",props:{mode:{type:String,default:l["t"]},value:{type:Object,default:()=>{}}},components:{Loading:_["a"],Values:R,PolicyReadmePanel:q},async fetch(){},async mounted(){var e;if(this.chartValues={policy:this.value,questions:null},null!==(e=this.value)&&void 0!==e&&null!==(e=e.metadata)&&void 0!==e&&null!==(e=e.annotations)&&void 0!==e&&e[x["b"]])try{const e=await this.value.artifactHubPackageVersion();var t;if(e&&!e.error)if(this.artifactHubPackage=e,e.description&&(this.shortDescription=e.description),e.readme&&(this.policyReadme=JSON.parse(JSON.stringify(e.readme))),null!==(t=e.data)&&void 0!==t&&t[x["c"].QUESTIONS]){var a;const t=structuredClone(x["d"]),s=g()(t.spec.settings,null===(a=this.chartValues.policy)||void 0===a||null===(a=a.spec)||void 0===a?void 0:a.settings);Object(k["i"])(this.chartValues.policy.spec,"settings",s),this.policyQuestions=this.value.parsePackageMetadata(e.data[x["c"].QUESTIONS]),this.policyQuestions&&Object(k["i"])(this.chartValues,"questions",this.policyQuestions)}}catch(s){console.warn("Unable to fetch artifacthub package: "+s)}this.yamlValues=Object(w["c"])(this.value)},data(){return{artifactHubPackage:null,chartValues:null,yamlValues:"",policyQuestions:null,shortDescription:"",policyReadme:null}},methods:{showReadme(){this.$refs.readmePanel.show()}}},H=F,z=(a("da42"),Object(I["a"])(H,b,f,!1,null,"63892b7c",null)),U=z.exports,Q=function(){var e=this,t=e._self._c;return t("div",[e.hideArtifactHubBanner?e._e():[t("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{"data-testid":"kw-policy-create-ah-banner",color:"warning",closable:!0},on:{close:function(t){return e.closeBanner("updateHideBannerArtifactHub")}}},[t("div",[t("p",{directives:[{name:"clean-html",rawName:"v-clean-html",value:"Official Kubearmor policies are hosted on ArtifactHub. In order to show these, you will need to add to the whitelist-domain setting.",expression:"('Official Kubearmor policies are hosted on ArtifactHub. In order to show these, you will need to add to the whitelist-domain setting.')"}],staticClass:"mb-10"}),t("AsyncButton",{attrs:{mode:"artifactHub"},on:{click:e.addArtifactHub}})],1)])],e.value&&!e.loadingPackages?t("Wizard",{ref:"wizard",staticClass:"wizard",attrs:{"data-testid":"kw-policy-create-wizard",errors:e.errors,steps:e.steps,"show-banner":!1,"edit-first-step":!0},on:{next:e.reset,cancel:e.done,finish:e.finish},scopedSlots:e._u([{key:"policies",fn:function(){return[t("PolicyTable",{attrs:{"data-testid":"kw-policy-create-table",value:e.packages},on:{selectType:function(t){return e.selectType(t)}}})]},proxy:!0},{key:"values",fn:function(){return[t("div",{staticClass:"banner__title"},[t("h2",[e._v(e._s(e.bannerTitle))]),e._v(" "+e._s()+" "),e.customPolicy?e._e():[t("p",{staticClass:"banner__short-description"},[e._v(" "+e._s(e.shortDescription)+" ")]),t("button",{staticClass:"btn btn-sm role-link banner__readme-button",on:{click:e.showReadme}},[e._v(" "+e._s("Show Readme")+" ")])]],2),t("Values",{attrs:{value:e.value,"chart-values":e.chartValues,"yaml-values":e.yamlValues,mode:e.mode,"custom-policy":e.customPolicy},on:{editor:t=>e.yamlOption=t,updateYamlValues:t=>e.yamlValues=t}})]},proxy:!0},{key:"finish",fn:function(){return[t("AsyncButton",{attrs:{"data-testid":"kw-policy-create-finish-button",disabled:!e.canFinish,mode:"finish"},on:{click:e.finish}})]},proxy:!0}],null,!1,2519213436),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}):e._e(),e.packageValues&&!e.customPolicy?[t("PolicyReadmePanel",{ref:"readmePanel",attrs:{"package-values":e.packageValues}}),void 0]:e._e()],2)},W=[],J=a("9e74"),K=a.n(J),X=a("4048"),Z=a("6418"),ee=a("d709"),te=a("ed59"),ae=a("f010"),se=function(){var e=this,t=e._self._c;return t("div",{staticClass:"policy-table-container"},[t("div",{staticClass:"filter"},[e.attributeOptions.length?t("LabeledSelect",{staticClass:"filter__attributes",attrs:{"data-testid":"kw-table-filter-source",clearable:!0,taggable:!0,mode:e.mode,multiple:!0,"label-key":"kubearmor.utils.attributes.label",options:e.attributeOptions},on:{selecting:t=>e.handleAttributeSelect(t)},model:{value:e.attributes,callback:function(t){e.attributes=t},expression:"attributes"}}):e._e(),t("LabeledInput",{ref:"searchQuery",staticClass:"input-sm filter__search",attrs:{"data-testid":"kw-table-filter-search",mode:e.mode,label:"Search By Name",placeholder:"Enter Name"},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}}),t("button",{ref:"btn",staticClass:"btn role-tertiary filter__reset",attrs:{"data-testid":"kw-table-filter-refresh",type:"button"},on:{click:e.refresh}},[t("p",[e._v(" "+e._s("Reset Filter")+" ")])])],1),t("div",{staticClass:"policy-table-actions"},[t("button",{ref:"btn",staticClass:"btn role-tertiary",attrs:{"data-testid":"kw-table-custom-buttom",type:"button"},on:{click:function(t){return e.$emit("selectType","custom")}}},[t("p",[e._v(" "+e._s("Create Custom Policy")+" ")])])]),t("SortableTableWrapper",{attrs:{rows:e.filteredSubtypes,headers:e.POLICY_TABLE_HEADERS,"table-actions":!1,"row-actions":!1,"key-field":"package_id","default-sort-by":"name",paging:!0,search:!1},on:{selectRow:t=>e.$emit("selectType",t)}})],1)},oe=[],ie=a("d1f7"),re=a.n(ie),le=a("5000"),ne=a("2cb5"),ce=a("1d19"),ue=a("466b"),de=a("8e93"),pe=a("0df0"),he=a("5191"),me=function(){var e=this,t=e._self._c;return t("div",[t("SortableTable",{ref:"sortableTable",attrs:{rows:e.rows,headers:e.headers,"table-actions":e.tableActions,"row-actions":e.rowActions,"key-field":e.keyField,"default-sort-by":e.defaultSortBy,paging:e.paging,search:e.search}})],1)},ve=[],be=a("0fb1"),fe={props:{rows:{type:Array,required:!0},headers:{type:Array,required:!0},tableActions:{type:Boolean,default:!1},rowActions:{type:Boolean,default:!1},keyField:{type:String,required:!0},defaultSortBy:{type:String,default:""},paging:{type:Boolean,default:!1},search:{type:Boolean,default:!1}},components:{SortableTable:be["b"]},data(){return{listeners:[]}},watch:{rows(){this.addRowClickListener()}},mounted(){this.addRowClickListener()},methods:{addRowClickListener(){this.$nextTick(()=>{var e;const t=null===(e=this.$refs.sortableTable)||void 0===e||null===(e=e.$el)||void 0===e?void 0:e.querySelector("table");t&&(this.removeRowClickListener(),t.querySelectorAll("tbody tr").forEach((e,t)=>{const a=()=>this.$emit("selectRow",this.rows[t]);null===e||void 0===e||e.addEventListener("click",a),this.listeners.push({row:e,listener:a})}))})},removeRowClickListener(){var e;null===(e=this.listeners)||void 0===e||e.forEach(({row:e,listener:t})=>null===e||void 0===e?void 0:e.removeEventListener("click",t)),this.listeners=[]}}},ye=fe,ge=Object(I["a"])(ye,me,ve,!1,null,null,null),we=ge.exports,ke={props:{mode:{type:String,default:l["n"]},value:{type:Array,default:()=>[]}},components:{Checkbox:pe["a"],LabeledSelect:ue["a"],LabeledInput:de["a"],SortableTableWrapper:we},fetch(){const e=this.$route.query;this.category=e[l["c"]]||"",this.searchQuery=e[l["f"]]||""},data(){return{KUBEARMOR_PRODUCT_NAME:x["i"],POLICY_TABLE_HEADERS:he["e"],attributes:[this.t("kubearmor.utils.attributes.optionLabels.all")],searchQuery:null,hidePackages:[]}},computed:{allSchemas(){return this.$store.getters["cluster/all"](S["w"])},filteredPackages(){var e;const t=null===(e=this.value)||void 0===e?void 0:e.filter(e=>{const t=this.isPrerelease(e);return!(!this.showPreRelease&&t)});return t||[]},filteredSubtypes(){const e=this.filteredPackages||[],t=e.filter(e=>{if(this.searchQuery){const t=this.searchQuery.split(/\s*[, ]\s*/).map(e=>Object(ne["e"])(e,!1)),a=t.every(t=>{var a,s;return(null===(a=e.display_name)||void 0===a?void 0:a.match(t))||e.description&&e.description.match(t)||(null===(s=e.keywords)||void 0===s?void 0:s.some(e=>e.match(t)))});if(!a)return!1}if(this.attributes.length){if(this.attributes.includes(this.t("kubearmor.utils.attributes.optionLabels.all")))return!0;const t=this.attributes.some(t=>{var a;const s=this.featureOptions.includes(t);if(s){var o;const a="Mutation"===t?"mutation":"contextAwareResources";return null===(o=e.data)||void 0===o?void 0:o["kubearmor/"+a]}return null===(a=e.data)||void 0===a||null===(a=a["kubearmor/resources"])||void 0===a?void 0:a.includes(t)});if(!t)return!1}return!0});return Object(ce["a"])(t,["name"])},attributeOptions(){const e=[];return this.resourceOptions.length&&e.push({kind:"group",label:this.t("kubearmor.utils.attributes.optionLabels.resource")},...this.resourceOptions),this.featureOptions.length&&e.push({kind:"group",label:this.t("kubearmor.utils.attributes.optionLabels.features")},...this.featureOptions),e.length&&e.unshift(this.t("kubearmor.utils.attributes.optionLabels.all"),{kind:"divider",label:"divider"}),e},featureOptions(){const e=[];for(const s of this.filteredPackages){var t,a;"true"===(null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t["kubearmor/mutation"])&&e.push("Mutation"),null!==s&&void 0!==s&&null!==(a=s.data)&&void 0!==a&&a["kubearmor/contextAwareResources"]&&e.push("Context Aware")}return e&&0!==e.length?[...new Set(e.filter(Boolean))]:[]},resourceOptions(){var e;const t=null===(e=this.filteredPackages)||void 0===e?void 0:e.flatMap(e=>{var t;return(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t["kubearmor/resources"])||[]});return t&&0!==t.length?[...new Set(t.filter(Boolean))]:[]},showPreRelease(){return this.$store.getters["prefs/get"](le["j"])}},methods:{isPrerelease(e){return!!re.a.prerelease(e.version)},refresh(){this.category=null,this.attributes=[this.t("kubearmor.utils.attributes.optionLabels.all")],this.searchQuery=null},handleAttributeSelect(e){const t=this.t("kubearmor.utils.attributes.optionLabels.all");e.includes(t)&&(1===e.length||0!==e.indexOf(t))?this.attributes=[t]:this.attributes=e.filter(e=>e!==t)}}},_e=ke,xe=(a("1f6e"),Object(I["a"])(_e,se,oe,!1,null,"556e35b7",null)),Oe=xe.exports,Ce={name:"Create",props:{mode:{type:String,default:l["n"]},value:{type:Object,default:()=>({})}},components:{AsyncButton:ee["b"],Banner:Z["a"],Loading:_["a"],Wizard:te["a"],PolicyTable:Oe,PolicyReadmePanel:q,Values:R},mixins:[n["a"]],created(){this.$store.dispatch("management/all",{type:S["k"].SETTING})},async fetch(){var e,t,a;this.hasArtifactHub&&await this.getPackages(),this.value.apiVersion=`${null===(e=this.schema)||void 0===e||null===(e=e.attributes)||void 0===e?void 0:e.group}.${null===(t=this.schema)||void 0===t||null===(t=t.attributes)||void 0===t?void 0:t.version}`,this.value.kind=null===(a=this.schema)||void 0===a||null===(a=a.attributes)||void 0===a?void 0:a.kind},data(){return{bannerTitle:null,shortDescription:null,loadingPackages:!1,packages:null,repository:null,type:null,typeModule:null,version:null,chartValues:{policy:{},questions:{}},yamlValues:"",hasCustomPolicy:!1,yamlOption:"form",finishAttempts:0,stepPolicies:{hidden:!1,name:"policies",label:"Policies",ready:!1,showSteps:!1,weight:99},stepValues:{name:"values",label:"Values",ready:!0,showSteps:!1,weight:98},hideArtifactHubBanner:!1}},computed:{isCreate(){return this.realMode===l["n"]},isSelected(){return!!this.type},customPolicy(){return"custom"===this.type},canFinish(){var e;return this.yamlOption===x["j"].YAML||!(null===(e=this.chartValues)||void 0===e||null===(e=e.policy)||void 0===e||!e.metadata.name)&&this.hasRequired},hasRequired(){var e;if(!d()(null===(e=this.chartValues)||void 0===e?void 0:e.policy)&&this.chartValues.policy.spec){const{selector:e,process:t,file:a}=this.chartValues.policy.spec,s=["matchLabels"],o=this.acceptedValues(e,s),i=["matchPaths","matchDirectories","matchPatterns"],r=i.some(e=>!d()(null===t||void 0===t?void 0:t[e])&&t[e].some(e=>e.path||e.dir||e.pattern)),l=["matchPaths","matchDirectories","matchPatterns"],n=l.some(e=>!d()(null===a||void 0===a?void 0:a[e])&&a[e].some(e=>e.path||e.dir||e.pattern));if(!d()(o)&&r&&n)return!0}return!1},hasArtifactHub(){return this.value.artifactHubWhitelist},whitelistSetting(){return this.$store.getters["management/all"](S["k"].SETTING).find(e=>"whitelist-domain"===e.id)},packageValues(){var e,t;return null!==(e=this.type)&&void 0!==e&&e.name?null===(t=this.packages)||void 0===t?void 0:t.find(e=>e.name===this.type.name):null},steps(){return[this.stepPolicies,this.stepValues].sort((e,t)=>t.weight-e.weight)}},watch:{type(e){null!==e&&void 0!==e&&e.name&&console.log("Type updated, fetching packageValues")}},methods:{acceptedValues(e,t){if(d()(t))return null;let a;return a=Array.isArray(e)?e.find(e=>this.checkProperties(e,t)):this.checkProperties(e,t),a},checkProperties(e,t){const a=[];if(!d()(t)){for(const s of t.values())d()(e[s])||a.push(s);if(t&&K()(a,t))return e}return null},async closeBanner(e,t=0){try{const a=await this.$store.dispatch("kubearmor/"+e,!0);0===t&&"error"===(null===a||void 0===a?void 0:a.type)&&500===(null===a||void 0===a?void 0:a.status)&&await this.closeBanner(e,t+1)}catch(a){console.error("Error closing banner:",a)}},async createNamespace(e){const t=this.$store.getters["cluster/all"](S["m"]),a={type:S["m"],metadata:{name:e},disableOpenApiValidation:!1},s=null===t||void 0===t?void 0:t.find(t=>{var a;return(null===t||void 0===t||null===(a=t.metadata)||void 0===a?void 0:a.name)===e});if(!s){const e=await this.$store.dispatch("cluster/create",a);try{await e.save()}catch(o){this.errors.push(o)}}},async addArtifactHub(){try{this.loadingPackages=!0,await this.updateWhitelist("artifacthub.io"),await this.getPackages(),this.loadingPackages=!1,this.hideArtifactHubBanner=!0}catch(e){v({error:e,store:this.$store}),this.loadingPackages=!1}},async updateWhitelist(e){const t=this.whitelistSetting;if(!t||!t.value)return void console.warn("Whitelist setting not found or value is undefined");const a=t.value.split(",");if(a.includes(e))console.log(e+" is already in the whitelist.");else{a.push(e),t.value=a.join();try{await t.save(),console.log(`Successfully added ${e} to the whitelist.`)}catch(s){const e=(null===s||void 0===s?void 0:s.data)||s;console.error("Error saving whitelist:",e)}}},async artifactHubRepo(){let e="/meta/proxy/";const t="packages/search",a={kind:19,limit:50};e+=`${x["a"]}/${t}`,e=Object(X["b"])(e,a);try{return await this.$store.dispatch("management/request",{url:e,redirectUnauthorized:!1},{root:!0})}catch(s){throw console.error("Error fetching ArtifactHub reposito ReferenceError: chartValues is not definedry:",s),s}},parsePackageMetadata(e){if(e){const t=JSON.parse(JSON.stringify(e));return r.a.load(t)}return null},artifactHubPackage(e){try{const t=`/meta/proxy/${x["a"]}/packages/kubearmor/${e.repository.name}/${e.name}`;return this.$store.dispatch("management/request",{url:t,redirectUnauthorized:!1},{root:!0})}catch(t){throw console.warn("Error fetching package: "+t),t}},done(){var e;this.$router.replace({name:"c-cluster-product-resource",params:{cluster:this.$route.params.cluster,product:"kubearmor",resource:null===(e=this.schema)||void 0===e?void 0:e.id}})},async finish(e){try{var t;let o;var a,s;if("YAML"===this.yamlOption)o=r.a.load(this.yamlValues);else o=null!==(a=this.chartValues)&&void 0!==a&&a.policy?this.chartValues.policy:r.a.load(this.yamlValues);if(m(o),this.finishAttempts>0?(Object.keys(this.value.spec).forEach(e=>{e in o.spec||this.$delete(this.value.spec,e)}),Object.keys(o.spec).forEach(e=>{this.$set(this.value.spec,e,o.spec[e])})):g()(this.value,o),this.chartType===x["g"].ADMISSION_POLICY&&null!==(t=this.chartValues)&&void 0!==t&&t.isNamespaceNew)await this.createNamespace(null===(s=this.value)||void 0===s||null===(s=s.metadata)||void 0===s?void 0:s.namespace);await this.attemptSave(e)}catch(o){console.error("Error creating Kubearmor policy:",o)}},async attemptSave(e){if(await this.save(e),this.errors&&this.errors.length>0){const e=new Error("Save operation failed");throw this.finishAttempts++,e}},async getPackages(){try{var e;if(this.repository=await this.artifactHubRepo(),(null===(e=this.repository)||void 0===e?void 0:e.packages.length)>0){const e=await Promise.all(this.repository.packages.map(this.packageDetails));this.packages=e.filter(e=>{var t;return"true"!==(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t["kubearmor/hidden-ui"])})}}catch(t){v({error:t,store:this.$store}),console.warn("Error fetching packages:",t)}},async packageDetails(e){try{return await this.artifactHubPackage(e)}catch(t){console.error("Error fetching package details:",t)}},policyQuestions(){var e;const t=structuredClone(x["d"]);if(this.customPolicy){const e={spec:{contextAwareResources:[]}};return g()(t,e),Object(k["i"])(this.chartValues,"policy",t),void(this.yamlValues=Object(w["c"])(t))}const a=this.packages.find(e=>{var t;return e.name===(null===(t=this.type)||void 0===t?void 0:t.name)});if(!a)return;const s=this.parsePackageMetadata(null===a||void 0===a||null===(e=a.data)||void 0===e?void 0:e[ae["a"].QUESTIONS]);let o;try{o=r.a.load(Object.values(a.data.policies)[0])}catch(l){return void console.error("Error loading policy YAML:",l)}const i=g()(t,o);Object(k["i"])(this.chartValues,"policy",i),this.yamlValues=Object(w["c"])(i),s&&Object(k["i"])(this.chartValues,"questions",s),this.shortDescription=null===a||void 0===a?void 0:a.description},reset(e){this.$nextTick(()=>{var t;if((null===(t=e.step)||void 0===t?void 0:t.name)===this.stepPolicies.name){const e=["errors","bannerTitle","shortDescription","type","typeModule","version","hasCustomPolicy"];e.forEach(e=>this[e]=null),this.stepPolicies.ready=!1,this.stepValues.hidden=!1,this.chartValues={policy:{},questions:{}},this.yamlOption="form",this.yamlValues=""}})},selectType(e){var t;this.type=e,this.customPolicy?this.$set(this,"hasCustomPolicy",!0):this.$set(this,"hasCustomPolicy",!1),this.policyQuestions(),this.stepPolicies.ready=!0,this.$refs.wizard.next(),this.bannerTitle=this.customPolicy?"Custom Policy":null===e||void 0===e?void 0:e.display_name,this.typeModule=null===(t=this.chartValues)||void 0===t||null===(t=t.policy)||void 0===t?void 0:t.spec.module},showReadme(){this.$nextTick(()=>{this.packageValues&&this.$refs.readmePanel?this.$refs.readmePanel.show():console.warn("PolicyReadmePanel is not rendered or packageValues are missing.")})}}},Se=Ce,Pe=(a("9f26"),Object(I["a"])(Se,Q,W,!1,null,"2761b367",null)),$e=Pe.exports,Me={name:"AdmissionPolicy",props:{value:{type:Object,required:!0},mode:{type:String,default:l["p"]},realMode:{type:String,default:l["p"]}},components:{CruResource:c["a"],Configed:U,Created:$e},mixins:[n["a"]],provide(){return{chartType:this.value.type,realMode:this.realMode}},computed:{isCreate(){return this.realMode===l["n"]}},methods:{async finish(e){try{m(this.value),await this.save(e)}catch(t){v({error:t,store:this.$store})}},updateYamlValuesFromEdit(e){const t=r.a.load(e);m(t),Object.assign(this.value,t)}}},Ve=Me,Le=(a("099d"),Object(I["a"])(Ve,s,o,!1,null,"7d654f0e",null));t["default"]=Le.exports},e646:function(e,t,a){var s=a("61c1");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("058848b8",s,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=kubearmor-0.1.0.umd.min.edit.js.map